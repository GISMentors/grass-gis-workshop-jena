Unit 07 - QGIS loves GRASS
==========================

Let's step out of the GRASS GIS environment for a moment. `QGIS
<http://qgis.org>`__ is a very popular open source GIS package which
made a significant progress in the last years. Nowadays it's used in
education, academic environment, but also in commercial settings. In
2002 QGIS started a multiplatform viewer for geospatial data. In the
recent years QGIS made important steps for being analytical
tool. Beside native algoritms QGIS offers also connection to
third-party software packages as SAGA, Orfeo or GRASS GIS. GRASS tools
can be run directly from QGIS enviroment without starting GRASS
explicitly.

Data produced by GRASS GIS may be easily accessed directly from
:item:`Browser` tab.

.. figure:: ../images/units/07/qgis-display-grass-data.png
   :class: middle
           
   Show data produced by GRASS GIS in QGIS environment.

.. note::

   QGIS has some issues with GRASS raster data symbology. Broken
   symbology may be fixed in :item:`Properties` dialog.

   .. figure:: ../images/units/07/qgis-raster-symbology.png
           
      Set raster symbology in QGIS.

It is also possible to run GRASS tools from **Processing** plugin.

Let's compute NDVI as described in :doc:`05` using :grasscmd:`i.vi`
GRASS tool, but in this case directly from QGIS UI. Load into QGIS
input data: Jena city region (:file:`geodata/osm/jena_boundary.gpkg`)
and Sentinel bands (red and near-infrared channels) from
:file:`geodata/sentinel/sample`.

.. figure:: ../images/units/07/qgis-input-data.png
   :class: middle
           
   Input data loaded in QGIS.

Processing plugin
-----------------

Processing plugin is a generic toolbox which allows to run tools
provided by QGIS or third-party software packages like eg. GRASS. Let's
open :menuselection:`Processing --> Toolbox` and search for
:grasscmd:`i.vi` GRASS module.

.. figure:: ../images/units/07/processing-i-vi.png
   :class: small
           
   Search for :grasscmd:`i.vi` GRASS module in Processing toolbox.

.. figure:: ../images/units/07/processing-i-vi-params.png
   :class: middle
                    
   Set input parameters (red and nir channels). Computation extent can
   be optionally defined in :item:`Advanced parameters` section.

:numref:`processing-i-vi-running` shows how Processing plugin
works. First of all a temporary GRASS location is created by
:grasscmd:`g.proj`, input data is linked into temporary location by
:grasscmd:`r.external`. Then computation can finally starts by running
:grasscmd:`i.vi` module. In the last step output data is exported out
of GRASS using :grasscmd:`r.out.gdal`. The resultant GeoTiff file is
vizualized in QGIS map window.

.. _processing-i-vi-running:

.. figure:: ../images/units/07/processing-i-vi-running.png
           
   Running :grasscmd:`i.vi` tool and exporting result from GRASS
   temporary location.
   
.. _processing-result:

.. figure:: ../images/units/07/processing-result.png
   :class: large
           
   Computed NDVI raster vizualized in QGIS map window (with better
   color interpretation than grayscale). No clouds mask involved.
